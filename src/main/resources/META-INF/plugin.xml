<idea-plugin>
    <!-- Core plugin identity -->
    <id>com.clipcraft</id>
    <name>ClipCraft</name>
    <version>5.0.0</version>
    <vendor url="https://clipcraft.com" email="support@clipcraft.com">
        ClipCraft Inc.
    </vendor>

    <!-- Brief, direct description -->
    <description><![CDATA[
        ClipCraft extracts and formats code from multiple files or directories, offers concurrency modes,
        dynamic ignoring, snippet previewing, GPT stubs for code analysis, and a wizard for setup.
    ]]></description>

    <!-- Minimal change notes: you can keep this short or remove entirely if not needed -->
    <change-notes><![CDATA[
        5.0.0:
        - Unified concurrency logic
        - .gitignore integration
        - Optional GPT stubs
        - Real-time snippet preview
    ]]></change-notes>

    <!-- Version constraints -->
    <idea-version since-build="223" until-build="243.*"/>

    <!-- If plugin requires Java classes -->
    <depends>com.intellij.modules.java</depends>
    <!-- If purely platform-based -->
    <!-- <depends>com.intellij.modules.platform</depends> -->

    <!-- Registering extensions in a single block for clarity -->
    <extensions defaultExtensionNs="com.intellij">
        <!-- Notification group for our plugin's balloons -->
        <notificationGroup id="ClipCraft" displayType="BALLOON"/>

        <!-- Settings UI registration -->
        <applicationConfigurable
                id="clipcraft.settings"
                instance="com.clipcraft.ui.ClipCraftSettingsConfigurable"
                displayName="ClipCraft"/>

        <!-- Because ClipCraftPerformanceMetrics is annotated with @Service(Service.Level.PROJECT),
             we do NOT register it here. IntelliJ loads it automatically. -->

        <!-- Tool window for snippet queue or GPT chat, anchored on left with a custom icon -->
        <toolWindow id="ClipCraft.SnippetQueue"
                    factoryClass="com.clipcraft.ui.ClipCraftToolWindowFactory"
                    anchor="left"
                    icon="com.clipcraft.icons.ClipCraftIcons.CLIPCRAFT_24"
                    secondary="true"/>
    </extensions>

    <!-- Unified action definitions -->
    <actions>
        <!-- Primary code-copying action -->
        <action id="ClipCraftCopyAction"
                class="com.clipcraft.actions.ClipCraftAction"
                text="ClipCraft Copy"
                description="Copies, formats, and merges code snippets"
                icon="com.clipcraft.icons.ClipCraftIcons.CLIPCRAFT_16">
            <!-- Appear in both Project and Editor context menus -->
            <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
        </action>

        <!-- Submenu group for other actions -->
        <group id="ClipCraft.Submenu"
               text="ClipCraft Actions"
               description="All ClipCraft plugin features"
               popup="true"
               class="com.intellij.openapi.actionSystem.DefaultActionGroup">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
        </group>

        <!-- Setup Wizard action -->
        <action id="ClipCraftWizardAction"
                class="com.clipcraft.actions.ClipCraftWizardAction"
                text="Setup Wizard"
                description="Guided configuration for ClipCraft">
            <add-to-group group-id="ClipCraft.Submenu" anchor="last"/>
        </action>

        <!-- Reset defaults action -->
        <action id="ClipCraftResetDefaultsAction"
                class="com.clipcraft.actions.ClipCraftResetDefaultsAction"
                text="Reset Defaults"
                description="Reset all ClipCraft settings to factory state">
            <add-to-group group-id="ClipCraft.Submenu" anchor="last"/>
        </action>

        <!-- Switch profile action -->
        <action id="ClipCraftSwitchProfileAction"
                class="com.clipcraft.actions.ClipCraftSwitchProfileAction"
                text="Switch Profile"
                description="Switch among multiple ClipCraft profiles">
            <add-to-group group-id="ClipCraft.Submenu" anchor="last"/>
        </action>

        <!-- Direct link to ClipCraft settings -->
        <action id="OpenClipCraftSettings"
                class="com.intellij.ide.actions.ShowSettingsAction"
                text="Open ClipCraft Settings"
                description="Opens the ClipCraft settings page">
            <add-to-group group-id="ClipCraft.Submenu" anchor="last"/>
        </action>

        <!-- Action for snippet from caret or selection -->
        <action id="ClipCraftAddSnippetFromCursorAction"
                class="com.clipcraft.actions.ClipCraftAddSnippetFromCursorOrSelectionAction"
                text="Add Snippet from Caret"
                description="Extract snippet from code near caret or selection">
            <add-to-group group-id="ClipCraft.Submenu" anchor="last"/>
        </action>
    </actions>
</idea-plugin>
